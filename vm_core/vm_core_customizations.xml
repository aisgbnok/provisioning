<?xml version="1.0" encoding="UTF-8"?>
<WindowsCustomizations>
  <PackageConfig xmlns="urn:schemas-Microsoft-com:Windows-ICD-Package-Config.v1.0">
    <ID>{a8dd246b-bb6f-4ba6-8664-a64444424b8d}</ID>
    <Name>Virtual Machine Core</Name>
    <Version>1.032</Version>
    <OwnerType>ITAdmin</OwnerType>
    <Rank>60</Rank>
    <Notes>Made specifically for Virtual Machines. Updates OneDrive and Edge, and installs Chrome, PowerShellCore, Windows Terminal, and AV1 and HEVC Video Extensions. Removes lots of provisoned apps including legacy Edge, 3DViewer, and Mixed Reality Portal. All files are up-to-date as of 9/21/2021.</Notes>
  </PackageConfig>
  <Settings xmlns="urn:schemas-microsoft-com:windows-provisioning">
    <Customizations>
      <Common>
        <ProvisioningCommands>
          <DeviceContext>
            <CommandFiles>
              <CommandFile Name="VM-Core_Custom-Assets">C:\provisioning\packages\vm_core\custom-scripts\VM-Core_Custom-Assets.bat</CommandFile>
              <CommandFile Name="VM-Core_Custom-Assets">C:\provisioning\packages\vm_core\custom-scripts\VM-Core_Custom-Assets.cab</CommandFile>
            </CommandFiles>
            <CommandLine>cmd /c "vm-core_custom-assets.bat"</CommandLine>
          </DeviceContext>
          <PrimaryContext>
            <Command>
              <CommandConfig Name="Microsoft_Edge_Update">
                <CommandFile>C:\provisioning\software\general\MicrosoftEdgeEnterpriseX64.msi</CommandFile>
                <CommandLine>msiexec /i "microsoftedgeenterprisex64.msi" /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
              <CommandConfig Name="PowerShell_7.1.4">
                <CommandFile>C:\provisioning\software\general\PowerShell-7.1.4-win-x64.msi</CommandFile>
                <CommandLine>msiexec /i "powershell-7.1.4-win-x64.msi" /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
              <CommandConfig Name="OneDrive_Update">
                <CommandFile>C:\provisioning\software\general\OneDriveSetup.exe</CommandFile>
                <CommandLine>cmd /c "onedrivesetup.exe" /allusers /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
              <CommandConfig Name="Google_Chrome">
                <CommandFile>C:\provisioning\software\general\GoogleChromeStandaloneEnterprise64.msi</CommandFile>
                <CommandLine>msiexec /i "googlechromestandaloneenterprise64.msi" /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
            </Command>
          </PrimaryContext>
        </ProvisioningCommands>
        <UniversalAppInstall>
          <DeviceContextApp>
            <Application PackageFamilyName="Microsoft.AV1VideoExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.AV1VideoExtension_1.1.41601.0\Microsoft.AV1VideoExtension_1.1.41601.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
              <DependencyAppxFiles>
                <Dependency Name="Microsoft.VCLibs.140.00_14.0.30035.0_x64__8wekyb3d8bbwe">C:\provisioning\uwp\Microsoft.AV1VideoExtension_1.1.41601.0\Microsoft.VCLibs.140.00_14.0.30035.0_x64__8wekyb3d8bbwe.Appx</Dependency>
              </DependencyAppxFiles>
            </Application>
            <Application PackageFamilyName="Microsoft.HEIFImageExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.HEIFImageExtension_1.0.42352.0\Microsoft.HEIFImageExtension_1.0.42352.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
            </Application>
            <Application PackageFamilyName="Microsoft.HEVCVideoExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.HEVCVideoExtension_1.0.42091.0\Microsoft.HEVCVideoExtension_1.0.42091.0_x64__8wekyb3d8bbwe.appx</ApplicationFile>
              <DependencyAppxFiles>
                <Dependency Name="Microsoft.VCLibs.140.00_14.0.30035.0_x64__8wekyb3d8bbwe">C:\provisioning\uwp\Microsoft.HEVCVideoExtension_1.0.42091.0\Microsoft.VCLibs.140.00_14.0.30035.0_x64__8wekyb3d8bbwe.appx</Dependency>
              </DependencyAppxFiles>
            </Application>
            <Application PackageFamilyName="Microsoft.VP9VideoExtensions_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.VP9VideoExtensions_1.0.41182.0\Microsoft.VP9VideoExtensions_1.0.41182.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
              <DependencyAppxFiles>
                <Dependency Name="Microsoft.VCLibs.140.00_14.0.30035.0_x64__8wekyb3d8bbwe">C:\provisioning\uwp\Microsoft.VP9VideoExtensions_1.0.41182.0\Microsoft.VCLibs.140.00_14.0.30035.0_x64__8wekyb3d8bbwe.Appx</Dependency>
              </DependencyAppxFiles>
            </Application>
            <Application PackageFamilyName="Microsoft.WindowsTerminal_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.WindowsTerminal_1.10.2383.0\620c2ec4eede4c9ebfd85594768a3bbf.msixbundle</ApplicationFile>
            </Application>
          </DeviceContextApp>
          <DeviceContextAppLicense>
            <LicenseInstall LicenseProductId="5c0db099-f413-5aa0-afc0-f40f668da91c">C:\provisioning\uwp\Microsoft.WindowsTerminal_1.10.2383.0\620c2ec4eede4c9ebfd85594768a3bbf_License1.xml</LicenseInstall>
          </DeviceContextAppLicense>
        </UniversalAppInstall>
        <UniversalAppUninstall>
          <RemoveProvisionedApp>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftEdgeDevToolsClient_8wekyb3d8bbwe" Name="Microsoft.MicrosoftEdgeDevToolsClient_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftEdge_8wekyb3d8bbwe" Name="Microsoft.MicrosoftEdge_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Xbox.TCUI_8wekyb3d8bbwe" Name="Microsoft.Xbox.TCUI_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MSPaint_8wekyb3d8bbwe" Name="Microsoft.MSPaint_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Getstarted_8wekyb3d8bbwe" Name="Microsoft.Getstarted_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftOfficeHub_8wekyb3d8bbwe" Name="Microsoft.MicrosoftOfficeHub_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Microsoft3DViewer_8wekyb3d8bbwe" Name="Microsoft.Microsoft3DViewer_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MixedReality.Portal_8wekyb3d8bbwe" Name="Microsoft.MixedReality.Portal_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.XboxApp_8wekyb3d8bbwe" Name="Microsoft.XboxApp_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.WindowsFeedbackHub_8wekyb3d8bbwe" Name="Microsoft.WindowsFeedbackHub_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.GamingApp_8wekyb3d8bbwe" Name="Microsoft.GamingApp_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.GetHelp_8wekyb3d8bbwe" Name="Microsoft.GetHelp_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftSolitaireCollection_8wekyb3d8bbwe" Name="Microsoft.MicrosoftSolitaireCollection_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.SkypeApp_kzf8qxf38zg5c" Name="Microsoft.SkypeApp_kzf8qxf38zg5c">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Office.OneNote_8wekyb3d8bbwe" Name="Microsoft.Office.OneNote_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.XboxGamingOverlay_8wekyb3d8bbwe" Name="Microsoft.XboxGamingOverlay_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
          </RemoveProvisionedApp>
        </UniversalAppUninstall>
      </Common>
    </Customizations>
  </Settings>
</WindowsCustomizations>