<?xml version="1.0" encoding="UTF-8"?>
<WindowsCustomizations>
  <PackageConfig xmlns="urn:schemas-Microsoft-com:Windows-ICD-Package-Config.v1.0">
    <ID>{a8dd246b-bb6f-4ba6-8664-a64444424b8b}</ID>
    <Name>Terminal</Name>
    <Version>1.033</Version>
    <OwnerType>ITAdmin</OwnerType>
    <Rank>30</Rank>
    <Notes>Installs PowerShellCore, Windows Terminal, and AV1, HEIF, HEVC, and VP9 Video Extensions on all computers and removes legacy Edge. All files are up-to-date as of 11/22/2021.</Notes>
  </PackageConfig>
  <Settings xmlns="urn:schemas-microsoft-com:windows-provisioning">
    <Customizations>
      <Common>
        <ProvisioningCommands>
          <DeviceContext>
            <CommandFiles>
              <CommandFile Name="Terminal_Custom-Assets">C:\provisioning\packages\terminal\custom-scripts\Terminal_Custom-Assets.bat</CommandFile>
              <CommandFile Name="Terminal_Custom-Assets">C:\provisioning\packages\terminal\custom-scripts\Terminal_Custom-Assets.cab</CommandFile>
            </CommandFiles>
            <CommandLine>cmd /c "terminal_custom-assets.bat"</CommandLine>
          </DeviceContext>
          <PrimaryContext>
            <Command>
              <CommandConfig Name="PowerShell_7.2.0">
                <CommandFile>C:\provisioning\software\general\PowerShell-7.2.0-win-x64.msi</CommandFile>
                <CommandLine>msiexec /i "powershell-7.2.0-win-x64.msi" /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
            </Command>
          </PrimaryContext>
        </ProvisioningCommands>
        <UniversalAppInstall>
          <DeviceContextApp>
            <Application PackageFamilyName="Microsoft.AV1VideoExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.AV1VideoExtension_1.1.41601.0\Microsoft.AV1VideoExtension_1.1.41601.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
              <DependencyAppxFiles>
                <Dependency Name="Microsoft.VCLibs.140.00_14.0.30704.0_x64__8wekyb3d8bbwe">C:\provisioning\uwp\Microsoft.AV1VideoExtension_1.1.41601.0\Microsoft.VCLibs.140.00_14.0.30704.0_x64__8wekyb3d8bbwe.Appx</Dependency>
              </DependencyAppxFiles>
            </Application>
            <Application PackageFamilyName="Microsoft.HEIFImageExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.HEIFImageExtension_1.0.43012.0\Microsoft.HEIFImageExtension_1.0.43012.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
            </Application>
            <Application PackageFamilyName="Microsoft.HEVCVideoExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.HEVCVideoExtension_1.0.43421.0\Microsoft.HEVCVideoExtension_1.0.43421.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
              <DependencyAppxFiles>
                <Dependency Name="Microsoft.VCLibs.140.00_14.0.30704.0_x64__8wekyb3d8bbwe">C:\provisioning\uwp\Microsoft.HEVCVideoExtension_1.0.43421.0\Microsoft.VCLibs.140.00_14.0.30704.0_x64__8wekyb3d8bbwe.Appx</Dependency>
              </DependencyAppxFiles>
            </Application>
            <Application PackageFamilyName="Microsoft.VP9VideoExtensions_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.VP9VideoExtensions_1.0.42791.0\Microsoft.VP9VideoExtensions_1.0.42791.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
            </Application>
            <Application PackageFamilyName="Microsoft.WindowsTerminal_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.WindowsTerminal_1.11.2921.0\92819c908a784e79a0f133d08d9e4bf2.msixbundle</ApplicationFile>
            </Application>
          </DeviceContextApp>
          <DeviceContextAppLicense>
            <LicenseInstall LicenseProductId="5c0db099-f413-5aa0-afc0-f40f668da91c">C:\provisioning\uwp\Microsoft.WindowsTerminal_1.11.2921.0\92819c908a784e79a0f133d08d9e4bf2_License1.xml</LicenseInstall>
          </DeviceContextAppLicense>
        </UniversalAppInstall>
        <UniversalAppUninstall>
          <RemoveProvisionedApp>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftEdgeDevToolsClient_8wekyb3d8bbwe" Name="Microsoft.MicrosoftEdgeDevToolsClient_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftEdge_8wekyb3d8bbwe" Name="Microsoft.MicrosoftEdge_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
          </RemoveProvisionedApp>
        </UniversalAppUninstall>
      </Common>
    </Customizations>
  </Settings>
</WindowsCustomizations>