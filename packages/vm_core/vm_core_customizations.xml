<?xml version="1.0" encoding="UTF-8"?>
<WindowsCustomizations>
  <PackageConfig xmlns="urn:schemas-Microsoft-com:Windows-ICD-Package-Config.v1.0">
    <ID>{a8dd246b-bb6f-4ba6-8664-a64444424b8d}</ID>
    <Name>Virtual Machine Core</Name>
    <Version>3.151</Version>
    <OwnerType>ITAdmin</OwnerType>
    <Rank>60</Rank>
    <Notes>Made specifically for Virtual Machines. Updates OneDrive and Edge, and installs Chrome, PowerShellCore, Windows Terminal, and AV1, HEIF, HEVC, and VP9 Video Extensions. Removes lots of provisioned apps including legacy Edge, 3DViewer, and Mixed Reality Portal. All files are up-to-date as of 2/13/2022.</Notes>
  </PackageConfig>
  <Settings xmlns="urn:schemas-microsoft-com:windows-provisioning">
    <Customizations>
      <Common>
        <ProvisioningCommands>
          <DeviceContext>
            <CommandFiles>
              <CommandFile Name="VM-Core_Custom-Assets">C:\provisioning\packages\vm_core\custom-scripts\VM-Core_Custom-Assets.bat</CommandFile>
              <CommandFile Name="VM-Core_Custom-Assets">C:\provisioning\packages\vm_core\custom-scripts\VM-Core_Custom-Assets.cab</CommandFile>
            </CommandFiles>
            <CommandLine>cmd /c "vm-core_custom-assets.bat"</CommandLine>
          </DeviceContext>
          <PrimaryContext>
            <Command>
              <CommandConfig Name="Microsoft_Edge_98.0.1108.50">
                <CommandFile>C:\provisioning\software\general\MicrosoftEdgeEnterpriseX64-98.0.1108.50.msi</CommandFile>
                <CommandLine>msiexec /i "microsoftedgeenterprisex64-98.0.1108.50.msi" /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
              <CommandConfig Name="PowerShell_7.2.1">
                <CommandFile>C:\provisioning\software\general\PowerShell-7.2.1-win-x64.msi</CommandFile>
                <CommandLine>msiexec /i "powershell-7.2.1-win-x64.msi" /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
              <CommandConfig Name="OneDrive_22.002.0103.0004">
                <CommandFile>C:\provisioning\software\general\OneDriveSetup-22.002.0103.0004.exe</CommandFile>
                <CommandLine>cmd /c "onedrivesetup-22.002.0103.0004.exe" /allusers /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
              <CommandConfig Name="Google_Chrome_98.0.4758.82">
                <CommandFile>C:\provisioning\software\general\GoogleChromeStandaloneEnterprise64-98.0.4758.82.msi</CommandFile>
                <CommandLine>msiexec /i "googlechromestandaloneenterprise64-98.0.4758.82.msi" /passive</CommandLine>
                <ContinueInstall>True</ContinueInstall>
                <RestartRequired>False</RestartRequired>
                <ReturnCodeRestart>3010</ReturnCodeRestart>
                <ReturnCodeSuccess>0</ReturnCodeSuccess>
              </CommandConfig>
            </Command>
          </PrimaryContext>
        </ProvisioningCommands>
        <UniversalAppInstall>
          <DeviceContextApp>
            <Application PackageFamilyName="Microsoft.AV1VideoExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.AV1VideoExtension_1.1.50332.0\Microsoft.AV1VideoExtension_1.1.50332.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
            </Application>
            <Application PackageFamilyName="Microsoft.HEIFImageExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.HEIFImageExtension_1.0.50272.0\Microsoft.HEIFImageExtension_1.0.50272.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
            </Application>
            <Application PackageFamilyName="Microsoft.HEVCVideoExtension_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.HEVCVideoExtension_1.0.50361.0\Microsoft.HEVCVideoExtension_1.0.50361.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
              <DependencyAppxFiles>
                <Dependency Name="Microsoft.VCLibs.140.00_14.0.30704.0_x64__8wekyb3d8bbwe">C:\provisioning\uwp\Microsoft.HEVCVideoExtension_1.0.50361.0\Microsoft.VCLibs.140.00_14.0.30704.0_x64__8wekyb3d8bbwe.Appx</Dependency>
              </DependencyAppxFiles>
            </Application>
            <Application PackageFamilyName="Microsoft.VP9VideoExtensions_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.VP9VideoExtensions_1.0.50274.0\Microsoft.VP9VideoExtensions_1.0.50274.0_x64__8wekyb3d8bbwe.Appx</ApplicationFile>
            </Application>
            <Application PackageFamilyName="Microsoft.WindowsTerminal_8wekyb3d8bbwe">
              <ApplicationFile>C:\provisioning\uwp\Microsoft.WindowsTerminal_1.12.10393.0\364f5988d6b4454786a7f1084ca6d589.msixbundle</ApplicationFile>
            </Application>
          </DeviceContextApp>
          <DeviceContextAppLicense>
            <LicenseInstall LicenseProductId="5c0db099-f413-5aa0-afc0-f40f668da91c">C:\provisioning\uwp\Microsoft.WindowsTerminal_1.12.10393.0\364f5988d6b4454786a7f1084ca6d589_License1.xml</LicenseInstall>
          </DeviceContextAppLicense>
        </UniversalAppInstall>
        <UniversalAppUninstall>
          <RemoveProvisionedApp>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftEdgeDevToolsClient_8wekyb3d8bbwe" Name="Microsoft.MicrosoftEdgeDevToolsClient_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftEdge_8wekyb3d8bbwe" Name="Microsoft.MicrosoftEdge_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Xbox.TCUI_8wekyb3d8bbwe" Name="Microsoft.Xbox.TCUI_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MSPaint_8wekyb3d8bbwe" Name="Microsoft.MSPaint_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Getstarted_8wekyb3d8bbwe" Name="Microsoft.Getstarted_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftOfficeHub_8wekyb3d8bbwe" Name="Microsoft.MicrosoftOfficeHub_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Microsoft3DViewer_8wekyb3d8bbwe" Name="Microsoft.Microsoft3DViewer_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MixedReality.Portal_8wekyb3d8bbwe" Name="Microsoft.MixedReality.Portal_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.XboxApp_8wekyb3d8bbwe" Name="Microsoft.XboxApp_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.WindowsFeedbackHub_8wekyb3d8bbwe" Name="Microsoft.WindowsFeedbackHub_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.GamingApp_8wekyb3d8bbwe" Name="Microsoft.GamingApp_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.GetHelp_8wekyb3d8bbwe" Name="Microsoft.GetHelp_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.MicrosoftSolitaireCollection_8wekyb3d8bbwe" Name="Microsoft.MicrosoftSolitaireCollection_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.SkypeApp_kzf8qxf38zg5c" Name="Microsoft.SkypeApp_kzf8qxf38zg5c">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.Office.OneNote_8wekyb3d8bbwe" Name="Microsoft.Office.OneNote_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
            <RemoveProvisionedApplication PackageFamilyName="Microsoft.XboxGamingOverlay_8wekyb3d8bbwe" Name="Microsoft.XboxGamingOverlay_8wekyb3d8bbwe">RemoveProvisionedApp</RemoveProvisionedApplication>
          </RemoveProvisionedApp>
        </UniversalAppUninstall>
      </Common>
    </Customizations>
  </Settings>
</WindowsCustomizations>